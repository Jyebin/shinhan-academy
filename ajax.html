<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
        var req = new XMLHttpRequest;
        req.open('get', 'https://jsonplaceholder.typicode.com/posts'); //이 url을 실행하면 우리 눈에는 보이지 않는 posts라는 요청이 일어나고, 
        req.send(); //객체를 초기화해서 보냄
        console.log(req.response); //f12를 눌러서 콘솔을 보면 출력이 안됨 -> 동기 방식이기 때문에 시점이 맞지 않기 때문

        req.onreadystatechange = function () {
            console.log('상태값 변경: ' + this.readyState);
            console.log('응답코드: ' + this.status);
            if (this.readyState === 4 && this.status === 200) {
                console.log(req.response); // 출력됨
            }
        };

        /*
        setTimeout() : 특정 시간 후에 실행
        setInterval() : 특정 시간 간격 마다 실행
        */
        window.onload = function () {
            var number;
            document.querySelector("#start").onclick = () => {
                console.log('시작');
                number = setInterval(function () {
                    console.log('setInterval');
                }, 1000);
            };
            document.querySelector("#end").onclick = () => {
                console.log('끝');
                clearInterval(number);
            };
        }

        // Promise
        function test(func) {
            return new Promise(function(resolve, reject) {
                setTimeout(function() {
                    resolve('Promise');
                }, 1000);
            });
        }
        console.log('시작');
        test().then(function(data) {
            console.log(data);
        });
        console.log('끝');

        // async함수 안에 await -> 이렇게 넣어야만 동기적으로 처리 가능
        async function test2() {
            var result = await test(function(data) {
                return data;
            });
            console.log('result')
        }
        test2();
        // await과 async가 빠지면 얘는 그냥 promise 객체가 된다.
        // 언제 사용? 비동기를 동기적으로 처리해야 할 때

        // AJAX (fetch)
        fetch('https://jsonplaceholder.typicode.com/posts')
            .then(res=>res.json()) // 콜백 함수. 화살표 함수를 괄호와 리턴을 생략한 것. 앞은 매개변수, 뒤는 리턴 값
            .then(data => console.log(data)); // 위 리턴 값이 이 함수의 매개변수(data)로 들어온다.
        // fetch는 그냥 함수! 프로미스 객체를 리턴해주는 역할.
        // url을 아까처럼 귀찮게 할 필요 없이, 손쉽게 사용해줄 수 있게 함
        // ajax -> 데이터를 비동기로 요청/응답하기 위해 사용
        // 왜 비동기로 받나여? : 새로 고침하지 않아도 UI가 실시간으로 변경될 수 있게 하기 위함 << 거의 필수.. 새로고침하면 느려지고 사용자경험 안 조아짐
    </script>
</head>

<body>
    <input type="button" value="시작" id="start">
    <input type="button" value="끝" id="end">
</body>

</html>